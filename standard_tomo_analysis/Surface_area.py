## This code was provided by H. O. SÃ¸rensen (NanoGeoScience Group, University of Copenhagen) 
##
## DICTIONARY OVER SURFACE AREAS
#
#Perm_area = {
#"00000000": 0.000000,
#"11111111": 0.000000,
#"10000000": 0.216500,
#"01000000": 0.216500,
#"00100000": 0.216500,
#"00010000": 0.216500,
#"00001000": 0.216500,
#"00000100": 0.216500,
#"00000010": 0.216500,
#"00000001": 0.216500,
#"01111111": 0.216500,
#"10111111": 0.216500,
#"11011111": 0.216500,
#"11101111": 0.216500,
#"11110111": 0.216500,
#"11111011": 0.216500,
#"11111101": 0.216500,
#"11111110": 0.216500,
#"11110000": 1.000000,
#"00001111": 1.000000,
#"10101010": 1.000000,
#"01010101": 1.000000,
#"11001100": 1.000000,
#"00110011": 1.000000,
#"10000001": 0.433000,
#"01000010": 0.433000,
#"00100100": 0.433000,
#"00011000": 0.433000,
#"01111110": 0.433000,
#"10111101": 0.433000,
#"11011011": 0.433000,
#"11100111": 0.433000,
#"11000000": 0.707100,
#"10100000": 0.707100,
#"01010000": 0.707100,
#"00110000": 0.707100,
#"10001000": 0.707100,
#"01000100": 0.707100,
#"00100010": 0.707100,
#"00010001": 0.707100,
#"00001100": 0.707100,
#"00001010": 0.707100,
#"00000011": 0.707100,
#"00000101": 0.707100,
#"00111111": 0.707100,
#"01011111": 0.707100,
#"10101111": 0.707100,
#"11001111": 0.707100,
#"01110111": 0.707100,
#"10111011": 0.707100,
#"11011101": 0.707100,
#"11101110": 0.707100,
#"11110011": 0.707100,
#"11110101": 0.707100,
#"11111100": 0.707100,
#"11111010": 0.707100,
#"10011001": 1.414200,
#"01100110": 1.414200,
#"10100101": 1.414200,
#"01011010": 1.414200,
#"11000011": 1.414200,
#"00111100": 1.414200,
#"10010110": 0.866000,
#"01101001": 0.866000,
#"10010000": 0.433000,
#"01100000": 0.433000,
#"00001001": 0.433000,
#"00000110": 0.433000,
#"10000010": 0.433000,
#"01000001": 0.433000,
#"00101000": 0.433000,
#"00010100": 0.433000,
#"10000100": 0.433000,
#"01001000": 0.433000,
#"00010010": 0.433000,
#"00100001": 0.433000,
#"01101111": 0.433000,
#"10011111": 0.433000,
#"11110110": 0.433000,
#"11111001": 0.433000,
#"01111101": 0.433000,
#"10111110": 0.433000,
#"11010111": 0.433000,
#"11101011": 0.433000,
#"01111011": 0.433000,
#"10110111": 0.433000,
#"11101101": 0.433000,
#"11011110": 0.433000,
#"11000010": 0.923600,
#"11000001": 0.923600,
#"01011000": 0.923600,
#"01010010": 0.923600,
#"00111000": 0.923600,
#"00110100": 0.923600,
#"10100100": 0.923600,
#"10100001": 0.923600,
#"10011000": 0.923600,
#"10001001": 0.923600,
#"01000110": 0.923600,
#"01100100": 0.923600,
#"10010001": 0.923600,
#"00011001": 0.923600,
#"01100010": 0.923600,
#"00100110": 0.923600,
#"00101100": 0.923600,
#"00011100": 0.923600,
#"10000101": 0.923600,
#"00100101": 0.923600,
#"10000011": 0.923600,
#"01000011": 0.923600,
#"01001010": 0.923600,
#"00011010": 0.923600,
#"00111101": 0.923600,
#"00111110": 0.923600,
#"10100111": 0.923600,
#"10101101": 0.923600,
#"11000111": 0.923600,
#"11001011": 0.923600,
#"01011011": 0.923600,
#"01011110": 0.923600,
#"01100111": 0.923600,
#"01110110": 0.923600,
#"10111001": 0.923600,
#"10011011": 0.923600,
#"01101110": 0.923600,
#"11100110": 0.923600,
#"10011101": 0.923600,
#"11011001": 0.923600,
#"11010011": 0.923600,
#"11100011": 0.923600,
#"01111010": 0.923600,
#"11011010": 0.923600,
#"01111100": 0.923600,
#"10111100": 0.923600,
#"10110101": 0.923600,
#"11100101": 0.923600,
#"11100000": 1.250000,
#"11010000": 1.250000,
#"01110000": 1.250000,
#"10110000": 1.250000,
#"00011111": 1.250000,
#"00101111": 1.250000,
#"10001111": 1.250000,
#"01001111": 1.250000,
#"00001110": 1.250000,
#"00001101": 1.250000,
#"00000111": 1.250000,
#"00001011": 1.250000,
#"11110001": 1.250000,
#"11110010": 1.250000,
#"11111000": 1.250000,
#"11110100": 1.250000,
#"10101000": 1.250000,
#"10100010": 1.250000,
#"00101010": 1.250000,
#"10001010": 1.250000,
#"01010111": 1.250000,
#"01011101": 1.250000,
#"11010101": 1.250000,
#"01110101": 1.250000,
#"01010100": 1.250000,
#"01010001": 1.250000,
#"00010101": 1.250000,
#"01000101": 1.250000,
#"10101011": 1.250000,
#"10101110": 1.250000,
#"11101010": 1.250000,
#"10111010": 1.250000,
#"11001000": 1.250000,
#"11000100": 1.250000,
#"01001100": 1.250000,
#"10001100": 1.250000,
#"00110111": 1.250000,
#"00111011": 1.250000,
#"10110011": 1.250000,
#"01110011": 1.250000,
#"00110010": 1.250000,
#"00110001": 1.250000,
#"00010011": 1.250000,
#"00100011": 1.250000,
#"11001101": 1.250000,
#"11001110": 1.250000,
#"11101100": 1.250000,
#"11011100": 1.250000,
#"01001001": 0.649500,
#"10110110": 0.649500,
#"00101001": 0.649500,
#"11010110": 0.649500,
#"10010010": 0.649500,
#"10010100": 0.649500,
#"01101000": 0.649500,
#"01100001": 0.649500,
#"01101101": 0.649500,
#"01101011": 0.649500,
#"10010111": 0.649500,
#"10011110": 0.649500,
#"10000110": 0.649500,
#"00010110": 0.649500,
#"01111001": 0.649500,
#"11101001": 0.649500,
#"01101010": 1.466500,
#"10010101": 1.466500,
#"01010110": 1.466500,
#"10101001": 1.466500,
#"01100011": 1.466500,
#"10011100": 1.466500,
#"00110110": 1.466500,
#"11001001": 1.466500,
#"10100110": 1.466500,
#"01011001": 1.466500,
#"00111001": 1.466500,
#"11000110": 1.466500,
#"10011010": 1.466500,
#"01100101": 1.466500,
#"11100001": 1.466500,
#"01101100": 1.466500,
#"10010011": 1.466500,
#"11010010": 1.466500,
#"01111000": 1.466500,
#"10110100": 1.466500,
#"00011110": 1.466500,
#"00101101": 1.466500,
#"10000111": 1.466500,
#"01001011": 1.466500,
#"11101000": 1.299900,
#"10110010": 1.299900,
#"01110001": 1.299900,
#"11010100": 1.299900,
#"00010111": 1.299900,
#"01001101": 1.299900,
#"10001110": 1.299900,
#"00101011": 1.299900,
#"10111000": 1.573200,
#"01000111": 1.573200,
#"00110101": 1.573200,
#"00011011": 1.573200,
#"10100011": 1.573200,
#"01110010": 1.573200,
#"11001010": 1.573200,
#"11100100": 1.573200,
#"01011100": 1.573200,
#"10001101": 1.573200,
#"11010001": 1.573200,
#"00101110": 1.573200,
#"01010011": 1.515500,
#"00100111": 1.515500,
#"00111010": 1.515500,
#"10110001": 1.515500,
#"10101100": 1.515500,
#"11011000": 1.515500,
#"11000101": 1.515500,
#"01001110": 1.515500,
#"01110100": 1.515500,
#"10001011": 1.515500,
#"11100010": 1.515500,
#"00011101": 1.515500
#}



def MC_Surface(volume):

    Perm_area = {
    "00000000": 0.000000,
    "11111111": 0.000000,
    "10000000": 0.216500,
    "01000000": 0.216500,
    "00100000": 0.216500,
    "00010000": 0.216500,
    "00001000": 0.216500,
    "00000100": 0.216500,
    "00000010": 0.216500,
    "00000001": 0.216500,
    "01111111": 0.216500,
    "10111111": 0.216500,
    "11011111": 0.216500,
    "11101111": 0.216500,
    "11110111": 0.216500,
    "11111011": 0.216500,
    "11111101": 0.216500,
    "11111110": 0.216500,
    "11110000": 1.000000,
    "00001111": 1.000000,
    "10101010": 1.000000,
    "01010101": 1.000000,
    "11001100": 1.000000,
    "00110011": 1.000000,
    "10000001": 0.433000,
    "01000010": 0.433000,
    "00100100": 0.433000,
    "00011000": 0.433000,
    "01111110": 0.433000,
    "10111101": 0.433000,
    "11011011": 0.433000,
    "11100111": 0.433000,
    "11000000": 0.707100,
    "10100000": 0.707100,
    "01010000": 0.707100,
    "00110000": 0.707100,
    "10001000": 0.707100,
    "01000100": 0.707100,
    "00100010": 0.707100,
    "00010001": 0.707100,
    "00001100": 0.707100,
    "00001010": 0.707100,
    "00000011": 0.707100,
    "00000101": 0.707100,
    "00111111": 0.707100,
    "01011111": 0.707100,
    "10101111": 0.707100,
    "11001111": 0.707100,
    "01110111": 0.707100,
    "10111011": 0.707100,
    "11011101": 0.707100,
    "11101110": 0.707100,
    "11110011": 0.707100,
    "11110101": 0.707100,
    "11111100": 0.707100,
    "11111010": 0.707100,
    "10011001": 1.414200,
    "01100110": 1.414200,
    "10100101": 1.414200,
    "01011010": 1.414200,
    "11000011": 1.414200,
    "00111100": 1.414200,
    "10010110": 0.866000,
    "01101001": 0.866000,
    "10010000": 0.433000,
    "01100000": 0.433000,
    "00001001": 0.433000,
    "00000110": 0.433000,   
    "10000010": 0.433000,
    "01000001": 0.433000,
    "00101000": 0.433000,
    "00010100": 0.433000,
    "10000100": 0.433000,
    "01001000": 0.433000,
    "00010010": 0.433000,
    "00100001": 0.433000,
    "01101111": 0.433000,
    "10011111": 0.433000,
    "11110110": 0.433000,
    "11111001": 0.433000,
    "01111101": 0.433000,
    "10111110": 0.433000,
    "11010111": 0.433000,
    "11101011": 0.433000,
    "01111011": 0.433000,
    "10110111": 0.433000,
    "11101101": 0.433000,
    "11011110": 0.433000,
    "11000010": 0.923600,
    "11000001": 0.923600,
    "01011000": 0.923600,
    "01010010": 0.923600,
    "00111000": 0.923600,
    "00110100": 0.923600,
    "10100100": 0.923600,
    "10100001": 0.923600,
    "10011000": 0.923600,
    "10001001": 0.923600,
    "01000110": 0.923600,
    "01100100": 0.923600,
    "10010001": 0.923600,
    "00011001": 0.923600,
    "01100010": 0.923600,
    "00100110": 0.923600,
    "00101100": 0.923600,
    "00011100": 0.923600,
    "10000101": 0.923600,
    "00100101": 0.923600,
    "10000011": 0.923600,
    "01000011": 0.923600,
    "01001010": 0.923600,
    "00011010": 0.923600,
    "00111101": 0.923600,
    "00111110": 0.923600,
    "10100111": 0.923600,
    "10101101": 0.923600,
    "11000111": 0.923600,
    "11001011": 0.923600,
    "01011011": 0.923600,
    "01011110": 0.923600,
    "01100111": 0.923600,
    "01110110": 0.923600,
    "10111001": 0.923600,
    "10011011": 0.923600,
    "01101110": 0.923600,
    "11100110": 0.923600,
    "10011101": 0.923600,
    "11011001": 0.923600,
    "11010011": 0.923600,
    "11100011": 0.923600,
    "01111010": 0.923600,
    "11011010": 0.923600,
    "01111100": 0.923600,
    "10111100": 0.923600,
    "10110101": 0.923600,
    "11100101": 0.923600,
    "11100000": 1.250000,
    "11010000": 1.250000,
    "01110000": 1.250000,
    "10110000": 1.250000,
    "00011111": 1.250000,
    "00101111": 1.250000,
    "10001111": 1.250000,
    "01001111": 1.250000,
    "00001110": 1.250000,
    "00001101": 1.250000,
    "00000111": 1.250000,
    "00001011": 1.250000,
    "11110001": 1.250000,
    "11110010": 1.250000,
    "11111000": 1.250000,
    "11110100": 1.250000,
    "10101000": 1.250000,
    "10100010": 1.250000,
    "00101010": 1.250000,
    "10001010": 1.250000,
    "01010111": 1.250000,
    "01011101": 1.250000,
    "11010101": 1.250000,
    "01110101": 1.250000,
    "01010100": 1.250000,
    "01010001": 1.250000,
    "00010101": 1.250000,
    "01000101": 1.250000,
    "10101011": 1.250000,
    "10101110": 1.250000,
    "11101010": 1.250000,
    "10111010": 1.250000,
    "11001000": 1.250000,
    "11000100": 1.250000,
    "01001100": 1.250000,
    "10001100": 1.250000,
    "00110111": 1.250000,
    "00111011": 1.250000,
    "10110011": 1.250000,
    "01110011": 1.250000,
    "00110010": 1.250000,
    "00110001": 1.250000,
    "00010011": 1.250000,
    "00100011": 1.250000,
    "11001101": 1.250000,
    "11001110": 1.250000,
    "11101100": 1.250000,
    "11011100": 1.250000,
    "01001001": 0.649500,
    "10110110": 0.649500,
    "00101001": 0.649500,
    "11010110": 0.649500,
    "10010010": 0.649500,
    "10010100": 0.649500,
    "01101000": 0.649500,
    "01100001": 0.649500,
    "01101101": 0.649500,
    "01101011": 0.649500,
    "10010111": 0.649500,
    "10011110": 0.649500,
    "10000110": 0.649500,
    "00010110": 0.649500,
    "01111001": 0.649500,
    "11101001": 0.649500,
    "01101010": 1.466500,
    "10010101": 1.466500,
    "01010110": 1.466500,
    "10101001": 1.466500,
    "01100011": 1.466500,
    "10011100": 1.466500,
    "00110110": 1.466500,
    "11001001": 1.466500,
    "10100110": 1.466500,
    "01011001": 1.466500,
    "00111001": 1.466500,
    "11000110": 1.466500,
    "10011010": 1.466500,
    "01100101": 1.466500,
    "11100001": 1.466500,
    "01101100": 1.466500,
    "10010011": 1.466500,
    "11010010": 1.466500,
    "01111000": 1.466500,
    "10110100": 1.466500,
    "00011110": 1.466500,
    "00101101": 1.466500,
    "10000111": 1.466500,
    "01001011": 1.466500,
    "11101000": 1.299900,
    "10110010": 1.299900,
    "01110001": 1.299900,
    "11010100": 1.299900,
    "00010111": 1.299900,
    "01001101": 1.299900,
    "10001110": 1.299900,
    "00101011": 1.299900,
    "10111000": 1.573200,
    "01000111": 1.573200,
    "00110101": 1.573200,
    "00011011": 1.573200,
    "10100011": 1.573200,
    "01110010": 1.573200,
    "11001010": 1.573200,
    "11100100": 1.573200,
    "01011100": 1.573200,
    "10001101": 1.573200,
    "11010001": 1.573200,
    "00101110": 1.573200,
    "01010011": 1.515500,
    "00100111": 1.515500,
    "00111010": 1.515500,
    "10110001": 1.515500,
    "10101100": 1.515500,
    "11011000": 1.515500,
    "11000101": 1.515500,
    "01001110": 1.515500,
    "01110100": 1.515500,
    "10001011": 1.515500,
    "11100010": 1.515500,
    "00011101": 1.515500
    }
    

    total_area = 0.0
    

    
    for k in range(volume.shape[2]-1):
        for j in range(volume.shape[1]-1):
            for i in range(volume.shape[0]-1):
                #print volume[i,j,k]

                pattern = '%i%i%i%i%i%i%i%i' %(
                volume[i  ,j  ,k],
                volume[i  ,j+1,k],
                volume[i+1,j  ,k],
                volume[i+1,j+1,k],
                volume[i,  j  ,k+1],
                volume[i  ,j+1,k+1],
                volume[i+1,j  ,k+1],
                volume[i+1,j+1,k+1])
                #print pattern, 'Area: ', Perm_area[pattern]
                total_area += Perm_area[pattern]
            
    return total_area

